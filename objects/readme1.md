## Введение
У нас стоит задача показывать информацию о неком "объекте" при клике на нем на картинке. 
Поскольку слово "объект" может нас путать с объектами языка программирования, давай будет называть это "сущностями".

Сейчас речь идет о зданиях, но не факт, что потом, как я говорил, не захочется полей, прудов и т.п.

Пока считаем, что в здании у нас может быть этажи, комнаты на этажах, деканаты и факультеты. 
И, в отсутствии другой информации, пока считаем, что деканаты и факультеты у нас так же располагаются на этажах зданий.
 
Давай всё же считать, что у нас всё же будет три типа сущности. Это поможет нам понять что будет одинаковое, а что - разное с самого начала:
- здание (`BuildingEntity`)
- пруд (`PondEntity`)
- поле (`FieldEntity`) 

У любой этой "сущности", будь то здание, пруд или поле, непременно будет какая-то информация, которую нужно будет показать.

Несмотря на то, что информация будет отличаться и показываться она может по-разному, она так или иначе должна быть показана по клику на ней. 
Это то, что __УЖЕ__ объединяет все эти сущности. 
Уже это позволяет объединить их все в один класс - класс сущностей карты. Назовем этот класс `MapEntity`

Еще давай считать, что у каждой этой сущности будет название.

Что приводит нас к тому что эти классы можно объявить вот так, пока не заморачиваясь сильно о конкретной реализации показа - будем выводить на консоль:

```ecmascript 6
  class MapEntity {
    title = ``;

    constructor(title) {
      this.title = title;
    }

    show() {
      console.log(`   ${this.title}`);
    }
  }

  class BuildingEntity extends MapEntity {
  }

  class PondEntity extends MapEntity {
  }

  class FieldEntity extends MapEntity {
  }
```

То есть у нас есть базовый класс `MapEntity` и три класса - наследника, которые __СЕЙЧАС__ ничем не отличаются от базового класса. Но, тем не менее, 
мы __УЖЕ СЕЙЧАС__ можем прекрасно манипулировать с каждым из них в общем списке, мы знаем что у них __У ВСЕХ__ есть название и они __ВСЕ__ могут показать себя.

__ОЧЕНЬ ВАЖНО__: мы __НАУЧИЛИ__ каждый класс показывать информацию о себе. Он __САМ__ знает как показать себя. Это действие делается не извне, а изнутри класса. 

```ecmascript 6
let mapEntities = [
    new BuildingEntity(`Ректорат`),
    new FieldEntity(`Опытное поле 1`),
    new FieldEntity(`Опытное поле 2`),
    new PondEntity(`Опытный пруд 1`),
    new PondEntity(`Опытный пруд 2`),
    new BuildingEntity(`Концертный зал`),
  ];

  mapEntities.forEach(entity => {
    entity.show();
  });
```

То есть в цикле нам абсолютно всё равно какого конкретно класса у нас объект, мы всё равно знаем, что он может себя показать.

Может возникнуть вопрос, а зачем нам общий список вообще? Нельзя ли обойтись разными списками для разных сущностей?

У того и другого подхода есть разные плюсы и минусы. У общего списка есть то преимущество, что в нем удобнее манипулировать со всеми сущностями. 
Например искать в нем по каким-то общим критериям. 
В отдельных списках проще исполнять операции, характерные именно для такого списка. Но об этом чуть позже.  

## Усложняем задачу: составляем список из внешнего источника
Предположим, что из базы данных получается какой-то список этих сущностей с их свойствами:

```ecmascript 6
  const dbData = {
    fields: [
      {
        title: 'Опытное поле №1',
      },
      {
        title: 'Опытное поле №2',
      }
    ],
    buildings: [
      {
        title: 'Ректорат',
      },
      {
        title: 'Концертный зал',
      },
      {
        title: 'Корпус №1',
      }
    ],
    ponds: [
      {
        title: 'Пруд №1',
      },
      {
        title: 'Пруд №2',
      }
    ]
  };
```

тогда мы можем создать общий список вот так:
```ecmascript 6
  let mapEntities = [];

  dbData.buildings.forEach(data => {
    mapEntities.push(new BuildingEntity(data.title));
  });

  dbData.fields.forEach(data => {
    mapEntities.push(new FieldEntity(data.title));
  });

  dbData.ponds.forEach(data => {
    mapEntities.push(new PondEntity(data.title));
  });
```

То есть поделив по типам и создав объекты нужных классов.

Структура БД может быть и другая, например такая:
```ecmascript 6
    const dbData = [
      {
        type: `field`,
        title: `Опытное поле №1`,
      },
      {
        type: `field`,
        title: `Опытное поле №2`,
      },
      {
        type: `building`,
        title: `Ректорат`,
      },
      {
        type: `building`,
        title: `Концертный зал`,
      },
      {
        type: `building`,
        title: `Корпус №1`,
      },
      {
        type: `pond`,
        title: `Пруд №1`,
      },
      {
        type: `pond`,
        title: `Пруд №2`,
      }
    ];
```

Тогда загрузка объектов будет выглядеть вот так:
```ecmascript 6
    let mapEntities = [];

    dbData.forEach(data => {
      let entity;

      switch (data.type) {
        case `building`:
          entity = new BuildingEntity(data.title);
          break;
        case `field`:
          entity = new FieldEntity(data.title);
          break;
        case `pond`:
          entity = new PondEntity(data.title);
          break;
      }

      mapEntities.push(entity);
    });
```

Результатом и тех и других манипуляций будет общий иерархический список сущностей с которым мы можем как-то работать. 
В частности вывести общий список или список сущностей отдельного класса вне зависимости от исходных данных

То есть структура у нас получаяется такая
- здание
    - этажи
        - этаж
            - комнаты
                - комната
                - комната
                - комната
            - деканаты
                - деканат
                - деканат
                - деканат
            - факультеты
                - факультет
                - факультет
        - этаж
            - комнаты
                - комната
                - комната
            - факультеты
                - факультет
- здание
    - этажи
        - комнаты
            - комната
            - комната
            - комната
        - деканаты
            - деканат
            - деканат
            - деканат
        - факультеты
            - факультет
            - факультет
- пруд
- пруд
- поле
- поле

см. [example1.html](example1.html)

- [предыдущая часть](readme.md)
- [следующая часть](readme2.md)
